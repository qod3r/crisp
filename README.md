# Распознавание дорожных знаков

```bash
git clone https://github.com/qod3r/crisp
cd crisp
pip install -r requirements.txt
```

## Содержание
1. [Бизнес-понимание](#бизнес-понимание)
2. [Понимание данных](#понимание-данных)
3. [Подготовка данных](#подготовка-данных)
4. [Моделирование](#моделирование)
5. [Оценка](#оценка)
6. [Внедрение](#внедрение)

## Бизнес-понимание
Цель проекта заключается в создании сервиса, использующего машинное обучение для нахождения и классификации знаков на панорамной съемке автомобильных дорог. Бизнес-целью является ускорение и упрощение процесса создания и обновления данных о дорожных знаках, а также снижение затрат на занесение дорог в систему. Ключевыми метриками для оценки модели будут точность классификации, скорость обработки кадров, надежность и устойчивость к различным условиям, а также экономические показатели и качество пользовательского опыта. Основными рисками являются недостаток данных, низкое их качество, высокие вычислительные затраты, несоответствие рыночным требованиям и сложности с масштабированием.

## Понимание данных
Лучшим кандидатом для обучения модели является российская база изображений автодорожных знаков [RTSD](https://disk.yandex.ru/d/TX5k2hkEm9wqZ), которая содержит около 170 тыс. кадров с видеорегистраторов, 104 тыс. из которых содержат знаки. Набор данных RTSD предназначен для задач распознавания дорожных знаков в реальном времени, включает изображения различных типов знаков в разных условиях освещения и погоды. Альтернативно можно использовать панорамные видео, снятые дорожной лабораторией ЦГАиК ИЦ КемГУ. Изображения в RTSD имеют размер 1280х720 или 1920х1080 в формате JPEG, с различным качеством и положением знаков, что может повлиять на эффективность алгоритмов обработки.

## Подготовка данных
Для решения проблемы распознавания редких классов дорожных знаков предлагается использовать синтетически сгенерированные изображения. Существуют различные методы обработки изображений для этих целей: Synt - встраивание знаков в фон с применением преобразований; CGI - рендеринг 3D-моделей знаков на реальных изображениях; CGI-GAN - улучшение CGI с помощью CycleGAN; Вставной - размещение искусственного знака на месте реального с последующим улучшением GAN; Циклический - встраивание знака того же класса для получения исходного изображения; Стилизованный - генерация синтетического знака на основе фона и значка требуемого класса. Эти методы могут применяться как для классификатора, так и для детектора дорожных знаков.

## Моделирование
Для решения задачи была выбрана архитектура ResNet(50), состоящая из 5 основных блоков с shortcut-соединениями, рассчитанная на работу с изображениями 224x224 пикселей и содержащая около 25 миллионов обучаемых параметров. Модель поставляется с предварительно обученными весами на наборе данных ImageNet, что позволяет применять ее как базовую модель для задач компьютерного зрения.

## Оценка
Сеть показывает высокую точность на самых распространенных классах знаков, но имеет смешанные результаты или не распознает вовсе некоторые редко встречающиеся классы. Общая точность сети на тестовом наборе составила 83%. Ввиду аппаратных ограничений, обучение производилось на процессоре с ограниченным количеством эпох, что занимало 4,5 часа. Использование видеокарты ускорит обучение примерно в 6 раз и позволит увеличить количество эпох, повышая точность.
